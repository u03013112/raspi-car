# 尽量减少时延，提高分辨率

## 减少时延

### 确认主要时延来源

    可能来源：
    1、摄像头采集时间
    2、网络传输时间
    3、视频播放时间（包括解码和显示）

    确认方案：通过摄像头拍摄屏幕上的时钟，确认各个时延
    1、本地简单代码测试，确认摄像头采集时间。这个还要注意，要对比不同分辨率和帧率的情况
        v4l2-ctl --list-formats-ext
    2、本地网络测试，和树莓派网络测试，对比总时延
    3、简化解码过程，确认解码时间

    针对3，可以直接代码计算收到1帧画面到现实的时间，确认解码（泛意）时间
    之间发现有一点帧根本没有被处理，这是解码时间过长，丢帧了
    是否应该确保不丢帧？即所有的后续处理要压缩在33ms之内完成？这个可能无法实现，如果无法实现一定会丢帧的
    如果将帧速率降低至20fps，那么由于帧速率就会产生至多50ms的时延

### 基础方案

    基于单摄像头720p 30fps 进行调整，这个分辨率和帧率是可以接受的
    可能这个分辨率的鱼眼转等距会比较困难，但是这可能也会使优化比较明显，这里可以考虑多线程
    另外等距转等角也是一个性能较低的部分
    争取将时延压在50ms以内

    预计在局域网内，网络是最不需要优化的部分，大致时延在30ms以内

    摄像头采集部分暂时不做优化，如果优化，只能重新买新的摄像头

    预计总体时延控制到200ms以内

    